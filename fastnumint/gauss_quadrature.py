_abscissae = {
    2: (
        -0.5773502691896257645091487805019574556476017512701268760186023264839776723029333456937153955857495252252087138051355676766566483649996508262705518373647912161760310773007685273559916067003615583077550051041144223011076288835574182229739459904090157105534559538626730166621791266197964892168,
        0.5773502691896257645091487805019574556476017512701268760186023264839776723029333456937153955857495252252087138051355676766566483649996508262705518373647912161760310773007685273559916067003615583077550051041144223011076288835574182229739459904090157105534559538626730166621791266197964892168
    ),
    3: (
        0,
        -0.774596669241483377035853079956479922166584341058318165317514753222696618387395806703857475371734703583260441372189929402637908087832729923135978349224240702213750958202698716256783906245777858513169283405612501838634682531972963691092925710263188052523534528101729260090115562126394576188,
        0.774596669241483377035853079956479922166584341058318165317514753222696618387395806703857475371734703583260441372189929402637908087832729923135978349224240702213750958202698716256783906245777858513169283405612501838634682531972963691092925710263188052523534528101729260090115562126394576188
    ),
    4: (
        -0.3399810435848562648026657591032446872005758697709143525929539768210200304632370344778752804355548115489602395207464932135845003241712491992776363684338328221538611182352836311104158340621521124125023821932864240034767086752629560943410821534146791671405442668508151756169732898924953195536,
        0.3399810435848562648026657591032446872005758697709143525929539768210200304632370344778752804355548115489602395207464932135845003241712491992776363684338328221538611182352836311104158340621521124125023821932864240034767086752629560943410821534146791671405442668508151756169732898924953195536,
        -0.8611363115940525752239464888928095050957253796297176376157219209065294714950488657041623398844793052105769209319781763249637438391157919764084938458618855762872931327441369944290122598469710261906458681564745219362114916066097678053187180580268539141223471780870198639372247416951073770551,
        0.8611363115940525752239464888928095050957253796297176376157219209065294714950488657041623398844793052105769209319781763249637438391157919764084938458618855762872931327441369944290122598469710261906458681564745219362114916066097678053187180580268539141223471780870198639372247416951073770551
    ),
    5: (
        0,
        -0.5384693101056830910363144207002088049672866069055599562022316270594711853677552910358036672505709315713670572321043495510816912158744046420683486075627481533978123828583369317846132387526796166796502053799563629878671716361660767584852200097418079241406256057571019602720019270523093750336,
        0.5384693101056830910363144207002088049672866069055599562022316270594711853677552910358036672505709315713670572321043495510816912158744046420683486075627481533978123828583369317846132387526796166796502053799563629878671716361660767584852200097418079241406256057571019602720019270523093750336,
        -0.9061798459386639927976268782993929651256519107625308628737622865437707949166868469411429895535422619115836248167051160932020660084349721915374869570125418659061700540273012086530604091207821562942704193786707298217315368769002376029537907738935528847397895557648103916797868140600953498906,
        0.9061798459386639927976268782993929651256519107625308628737622865437707949166868469411429895535422619115836248167051160932020660084349721915374869570125418659061700540273012086530604091207821562942704193786707298217315368769002376029537907738935528847397895557648103916797868140600953498906
    ),
    21: (
        0,
        -0.1455618541608950909370309823386863301163260244379377574214883899855472808833197976905159784382084529956266082997952460007075040921151901820428112534471870024703724579332928837035079755367538815793316156146400158058153270917220808648193815275448927816510217795212659005404310120555536728913,
        0.1455618541608950909370309823386863301163260244379377574214883899855472808833197976905159784382084529956266082997952460007075040921151901820428112534471870024703724579332928837035079755367538815793316156146400158058153270917220808648193815275448927816510217795212659005404310120555536728913,
        -0.2880213168024010966007925160646003199090182636460332287542815247492449429418427678533390283602168265723238791617336363509020032719055677588439011437295075253848866466102059812324940930815745168447895251753297598197301524506994190726759552143195130238824627797913404555316808711580182682429,
        0.2880213168024010966007925160646003199090182636460332287542815247492449429418427678533390283602168265723238791617336363509020032719055677588439011437295075253848866466102059812324940930815745168447895251753297598197301524506994190726759552143195130238824627797913404555316808711580182682429,
        -0.4243421202074387835736688885437880520964452318396345842242582358964868836788015569998720929138276376309566313050989439137979248644741104731993334592505568190169236699847381040870273883836476700987793302234135433126112630115064368087319980154514146292728577133674957217759495627376646354558,
        0.4243421202074387835736688885437880520964452318396345842242582358964868836788015569998720929138276376309566313050989439137979248644741104731993334592505568190169236699847381040870273883836476700987793302234135433126112630115064368087319980154514146292728577133674957217759495627376646354558,
        -0.5516188358872198070590187967243132866220602242306796650043058394996047817116840370569809878990309592180048618186085127986539581839966116358475084497332261955486687925146697068084161609399862695510915854061255660151217562406053600653289994499465184232452488051439649914204318815426394614627,
        0.5516188358872198070590187967243132866220602242306796650043058394996047817116840370569809878990309592180048618186085127986539581839966116358475084497332261955486687925146697068084161609399862695510915854061255660151217562406053600653289994499465184232452488051439649914204318815426394614627,
        -0.6671388041974123193059666699903391625970293433114028424754670823471941931156962952995104885627912599861509014899194203075230481425468470919727744164117007450331564507508905004243549142358469814572128624890397118349320300962946227950902884246548256414654793119470166973125451373884664938637,
        0.6671388041974123193059666699903391625970293433114028424754670823471941931156962952995104885627912599861509014899194203075230481425468470919727744164117007450331564507508905004243549142358469814572128624890397118349320300962946227950902884246548256414654793119470166973125451373884664938637,
        -0.7684399634756779086158778513062280348209767057713695508687266650300187425397011795870716590938643871439390931208768144578324899683024188464710839764510341977640330323660862974394548695637148446969135388151129528261437891627451388110373335026016797523271617163166815693712256959021324866801,
        0.7684399634756779086158778513062280348209767057713695508687266650300187425397011795870716590938643871439390931208768144578324899683024188464710839764510341977640330323660862974394548695637148446969135388151129528261437891627451388110373335026016797523271617163166815693712256959021324866801,
        -0.8533633645833172836472506385875676702761058031793439707429916293942429062838351469722896371916961144967023358118310085458992965478859672097401844738905087801697363313899810066602123084036251649665816868982392845672431116725197173385513388161170535143186830817606070997240426507354292546493,
        0.8533633645833172836472506385875676702761058031793439707429916293942429062838351469722896371916961144967023358118310085458992965478859672097401844738905087801697363313899810066602123084036251649665816868982392845672431116725197173385513388161170535143186830817606070997240426507354292546493,
        -0.920099334150400828790187133714968894159147609648221697176135487090981563069407828991731951372068269434200035492769902063252150777007948121807099749864013849736024717170355822216921609341213495687471373447551315592661432614385435011099947578920608251756285623579575597106956471250165978125,
        0.920099334150400828790187133714968894159147609648221697176135487090981563069407828991731951372068269434200035492769902063252150777007948121807099749864013849736024717170355822216921609341213495687471373447551315592661432614385435011099947578920608251756285623579575597106956471250165978125,
        -0.9672268385663062943166222149076951614246936873298468499529711280851209600050802879718374018639240527646293983749609070730588031439070533768944455074620467046102169941977006021847854662713269702363219945126440846238033747189487973795296995957404167028430371005551579646071964715083559627873,
        0.9672268385663062943166222149076951614246936873298468499529711280851209600050802879718374018639240527646293983749609070730588031439070533768944455074620467046102169941977006021847854662713269702363219945126440846238033747189487973795296995957404167028430371005551579646071964715083559627873,
        -0.9937521706203895002602420359379409291933384547823291855808738547130961090229928069981287471352390777288377053370241450143993363886632109591353148338638256333282393222478928076557337800765089605404093771754405796659131769242771089712887295358081081594782329648637555774855284519799161049686,
        0.9937521706203895002602420359379409291933384547823291855808738547130961090229928069981287471352390777288377053370241450143993363886632109591353148338638256333282393222478928076557337800765089605404093771754405796659131769242771089712887295358081081594782329648637555774855284519799161049686
    )
}

_weights = {
    2: (
        1.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
        1.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    ),
    3: (
        0.8888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888889,
        0.5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555556,
        0.5555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555556
    ),
    4: (
        0.6521451548625461426269360507780005927646513041661064595074706804812481325340896482780162322677418404902018960952364978455755577496740182191429757016783303751407135229556360801973666260481564013273531860737119707353160256000107787211587578617532049337456560923057986412084590467808124974086,
        0.6521451548625461426269360507780005927646513041661064595074706804812481325340896482780162322677418404902018960952364978455755577496740182191429757016783303751407135229556360801973666260481564013273531860737119707353160256000107787211587578617532049337456560923057986412084590467808124974086,
        0.3478548451374538573730639492219994072353486958338935404925293195187518674659103517219837677322581595097981039047635021544244422503259817808570242983216696248592864770443639198026333739518435986726468139262880292646839743999892212788412421382467950662543439076942013587915409532191875025701,
        0.3478548451374538573730639492219994072353486958338935404925293195187518674659103517219837677322581595097981039047635021544244422503259817808570242983216696248592864770443639198026333739518435986726468139262880292646839743999892212788412421382467950662543439076942013587915409532191875025701
    ),
    5: (
        0.5688888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888889,
        0.4786286704993664680412915148356381929122955533431415399727276673338382671525124569755621250616041107794464209474122299742927901670531874220236019762755381069981020199559708433435017355341690324695622104863536721598859262913644828482640505637133513606531929893286127565185389732581634388813,
        0.4786286704993664680412915148356381929122955533431415399727276673338382671525124569755621250616041107794464209474122299742927901670531874220236019762755381069981020199559708433435017355341690324695622104863536721598859262913644828482640505637133513606531929893286127565185389732581634388813,
        0.2369268850561890875142640407199173626432600022124140155828278882217172884030430985799934304939514447761091346081433255812627653885023681335319535792800174485574535355995847122120538200213865230859933450692018833956696292641910727072915049918422041949023625662269427990370165822973921166843,
        0.2369268850561890875142640407199173626432600022124140155828278882217172884030430985799934304939514447761091346081433255812627653885023681335319535792800174485574535355995847122120538200213865230859933450692018833956696292641910727072915049918422041949023625662269427990370165822973921166843
    ),
    21: (
        0.139251872855631993375410248341809957873920217457425858126197877073037712818768596298747496824058914113093167157962721105490063037735945705368013554774786449446301992859427256084690367597657268817092023841871315156005340599231398042635738899417087195975359991616234502233438058611331987745,
        0.139251872855631993375410248341809957873920217457425858126197877073037712818768596298747496824058914113093167157962721105490063037735945705368013554774786449446301992859427256084690367597657268817092023841871315156005340599231398042635738899417087195975359991616234502233438058611331987745,
        0.1365414983460151713525738312315173965863676529886861681094697349382075581645378333809906329322980338064166098619410384683080837352686179002153940492154657031000279046612887404941032702402863540489150533615329544848350259523513713718107237294224552847158550848712612535614861972824779777976,
        0.1365414983460151713525738312315173965863676529886861681094697349382075581645378333809906329322980338064166098619410384683080837352686179002153940492154657031000279046612887404941032702402863540489150533615329544848350259523513713718107237294224552847158550848712612535614861972824779777976,
        0.1311735047870623707329649925303074458757418941880306531253797034245446103135289740914341000330802590357453133430374671516356351504504246601963151768842030638131958733505362877145593040145815186758260217713701867970876075860868220072903240340382067261517549996687431186964515504642502351783,
        0.1311735047870623707329649925303074458757418941880306531253797034245446103135289740914341000330802590357453133430374671516356351504504246601963151768842030638131958733505362877145593040145815186758260217713701867970876075860868220072903240340382067261517549996687431186964515504642502351783,
        0.1232523768105124242855609861548144719594449990049679724284219718851355027991754540317802460344263428062179538248874191344588354067067945434706349235332478397563735704166808201424795855530810763983066837919814260363914879417089719256224363311637486835202619996443651660233049512097896196499,
        0.1232523768105124242855609861548144719594449990049679724284219718851355027991754540317802460344263428062179538248874191344588354067067945434706349235332478397563735704166808201424795855530810763983066837919814260363914879417089719256224363311637486835202619996443651660233049512097896196499,
        0.1129322960805392183934006074217843191142633321209947042725975462486131309236108336596048814249688672616781549051053825552718538410303432071472857511738274194595666330339049635233207892233756723419514293771341236682855672426337138118775758049252375609197111935963957307498339896884695320756,
        0.1129322960805392183934006074217843191142633321209947042725975462486131309236108336596048814249688672616781549051053825552718538410303432071472857511738274194595666330339049635233207892233756723419514293771341236682855672426337138118775758049252375609197111935963957307498339896884695320756,
        0.1004141444428809649320788378305362823508110887676996257849609143404530960742237727428606391633595573776349093540661740314708763653482563321696553170923589751450442384859766568385469374554135972424729074657466417224854304101874849974350913267934517683214118430098813097798290926305738073941,
        0.1004141444428809649320788378305362823508110887676996257849609143404530960742237727428606391633595573776349093540661740314708763653482563321696553170923589751450442384859766568385469374554135972424729074657466417224854304101874849974350913267934517683214118430098813097798290926305738073941,
        0.0859416062170677274144436813727028661891444053490797832865700110482460247731261574320222498147195279420031166714886305554569826230842395878601500101939183046172720437239928289392785032135016684742279615109509348640374882414379905254219055080017839272008510689158029965727382187052179071799,
        0.0859416062170677274144436813727028661891444053490797832865700110482460247731261574320222498147195279420031166714886305554569826230842395878601500101939183046172720437239928289392785032135016684742279615109509348640374882414379905254219055080017839272008510689158029965727382187052179071799,
        0.0697964684245204880949614189302176573987750529550805273863113717639464034872858940393928407934487484578347691548227869811070577976316010787643313789567315773077142560385751072667930433873534185706036938053329982020371598607210384850944336260599416771946201385073813370989287571075428730939,
        0.0697964684245204880949614189302176573987750529550805273863113717639464034872858940393928407934487484578347691548227869811070577976316010787643313789567315773077142560385751072667930433873534185706036938053329982020371598607210384850944336260599416771946201385073813370989287571075428730939,
        0.0522933351526832859403120512732112561121500935692363161227100832976763423599328247819681900497942379853944769639050807493316042515144884278871959026979582690008885621444759508018223720337014558360364717123912529925149692547390811951232658701582125573521341464543076941011085466862268500532,
        0.0522933351526832859403120512732112561121500935692363161227100832976763423599328247819681900497942379853944769639050807493316042515144884278871959026979582690008885621444759508018223720337014558360364717123912529925149692547390811951232658701582125573521341464543076941011085466862268500532,
        0.0337749015848141547933022468659129013491693144744746604328831945599515117530614883989149488223271820394668642314209914197484933174725421873500935790418921972193376234783246855382688816781804190261643002466304858994685158135658866855354087005529714468844343938457001078010839443093190369368,
        0.0337749015848141547933022468659129013491693144744746604328831945599515117530614883989149488223271820394668642314209914197484933174725421873500935790418921972193376234783246855382688816781804190261643002466304858994685158135658866855354087005529714468844343938457001078010839443093190369368,
        0.0146279952982722006849910980471854451902119491243237309244975914201881065327481711422837741075183291745146645313623078477205144737567463695709303564356102011342773018068167026561369456028675505684034531150576801768514070973362409521530961694669031717636051398699267833817966933073957187542,
        0.0146279952982722006849910980471854451902119491243237309244975914201881065327481711422837741075183291745146645313623078477205144737567463695709303564356102011342773018068167026561369456028675505684034531150576801768514070973362409521530961694669031717636051398699267833817966933073957187542
    )
}


def gauss_quadrature(f, a, b, n=5):
    scaling = (b - a) / 2
    midpoint = (a + b) / 2
    return sum(
        f(scaling * xi + midpoint) * wi for xi, wi in zip(_abscissae[n], _weights[n])) * scaling
